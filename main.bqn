#!/usr/bin/env bqn

Load â† {
    âŠ¢/ËœâŸœ(âˆ¾ğ•©âŠ¸=âˆ˜â‰¢Â¨) â€¢file.Lines ğ•¨âŠ£"WORD.LST" 
}

words â† Load 5

# â€¢Show 10â†‘words
# â€¢Show â‰¢words

Score â† {
    m â† ğ•¨=ğ•©
    nm â† Â¬m
    rw â† nm/ğ•¨
    rx â† nm/ğ•©
    (2Ã—m)+(nmâˆ§+`nm)âˆŠ1+/rx(âŠ’Ëœ<â‰ âˆ˜âŠ¢)rw
}

# secret â† 0âŠ‘words
# guess â†  9âŠ‘words
# sc â† secret Score guess

# â€¢Out "Secret: " âˆ¾ secret
# â€¢Out "Guess:  " âˆ¾ guess
# â€¢Show sc

WI â† {
    sâ€¿w â† ğ•¨
    c â† w/Ëœs=1
    nc â† w/Ëœs=0
    r â† (sâ‰ 2)âŠ¸/Â¨ğ•©
    m â† (âˆ§Â´câŠ¸(âŠ’Ëœ<â‰ âˆ˜âŠ¢))Â¨r
    nm â† (âˆ¨Â´ncâŠ¸(âŠ’Ëœ<â‰ âˆ˜âŠ¢))Â¨(Â¬câŠ¸((âŠ’Ëœ<â‰ âˆ˜âŠ¢)Ëœ))âŠ¸/Â¨r
    (mâˆ§Â¬nm)/ğ•©
}
IL â† {
    sâ€¿w â† ğ•¨
    c â† s=1
    m â† ((câŠ¸â‰¡câŠ¸Ã—)wâŠ¸â‰ )Â¨ğ•©
    m/ğ•©
}
CL â† {
    sâ€¿w â† ğ•¨
    c â† s=2
    m â† ((câŠ¸â‰¡câŠ¸Ã—)wâŠ¸=)Â¨ğ•©
    m/ğ•©
}

Filter â† { ğ•¨ WI ğ•¨ IL ğ•¨ CL ğ•© }

# scg â† (1â€¿2â€¿0â€¿0â€¿0)â€¿("abcba")
# â€¢Show scg Filter words

# This is brute force and super slow.
# ğ•¨ is the current list of possible secret words.
# ğ•© is the list of all guessable words.
# Sometimes guessing a word that isn't a possible secret
# can narrow down the list better than just using the possible secrets
BestGuess â† {
    w â† ğ•¨âŠ£ğ•©
    # Preprocess ğ•© to have ğ•¨ at the beginning this will make it get selected first.
    x â† w âˆ¾ w(Â¬âˆ˜âˆŠËœ/âŠ¢)ğ•©
    sc â† +Ëâ‰ Â¨w((<âˆ˜Score âˆ¾ <âˆ˜âŠ¢) Filter ğ•)âŒœx
    # â€¢Show sc
    bg â† âŠ‘â‹sc
    bgâŠ‘x
}

# possible â† 5â†‘words
# all â† 10â†‘words
# â€¢Out "Word that leads to lowest average remaining words: " âˆ¾ possible BestGuess all

# Actual test game/solving.
â€¢Out "Starting real game minigame with 100 random words"
all â† (âŠ¢/Ëœ(â†•âˆŠ100âŠ¸â€¢rand.Subset)âˆ˜â‰ ) words
# If wanted possible could be limited to match real wordle.
possible â† all

secret â† (â€¢rand.Rangeâˆ˜â‰ âŠ‘âŠ¢) possible
# â€¢Out "Secret: " âˆ¾ secret

chosen â† "     "
guesses â† 0

While â† {ğ•¨{ğ•Šâˆ˜ğ”¾âŸğ”½ğ•©}ğ•©@}Â´
While {ğ•¤â‹„(secretâ‰¢chosen)âˆ§guesses<6}â€¿{ğ•¤
    â€¢Out "Remaining possibile words:"
    â€¢Show possible
    â€¢Out "Chosen: " âˆ¾ chosen â†© possible BestGuess all
    â€¢Out "Score: " âˆ¾ â€¢Repr sc â† secret Score chosen
    possible â†© scâ€¿chosen Filter possible
    guesses +â†© 1
}

{
    secretâ‰¡chosen ?
        â€¢Out "Found secret word (" âˆ¾ secret âˆ¾ ") in " âˆ¾ (â€¢Repr guesses) âˆ¾ " guesses!"
    ;
        â€¢Out "Failed to figure out secret word. It was " âˆ¾ secret
}
